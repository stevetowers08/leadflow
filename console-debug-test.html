<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Empowr CRM - Console Debug Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: white;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            background: #1e293b;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #2563eb;
        }
        .success { background: #10b981; }
        .danger { background: #dc2626; }
        .warning { background: #f59e0b; }
        .log {
            background: #000;
            color: #00ff00;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            margin: 10px 0;
            max-height: 300px;
            overflow-y: auto;
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .status.success { background: #10b981; color: white; }
        .status.error { background: #dc2626; color: white; }
        .status.warning { background: #f59e0b; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Empowr CRM - Console Debug Test</h1>
        
        <div class="test-section">
            <h2>Test Results</h2>
            <div id="testResults"></div>
        </div>

        <div class="test-section">
            <h2>Actions</h2>
            <button class="button success" onclick="runAllTests()">Run All Tests</button>
            <button class="button" onclick="testMainApp()">Test Main App</button>
            <button class="button warning" onclick="enableDevBypass()">Enable Dev Bypass</button>
            <button class="button danger" onclick="clearAllData()">Clear All Data</button>
        </div>

        <div class="test-section">
            <h2>Console Log</h2>
            <div id="consoleLog" class="log"></div>
            <button class="button" onclick="clearLog()">Clear Log</button>
        </div>
    </div>

    <script>
        let logEntries = [];
        let testResults = [];

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const entry = `[${timestamp}] [${type.toUpperCase()}] ${message}`;
            logEntries.push(entry);
            console.log(entry);
            updateLogDisplay();
        }

        function updateLogDisplay() {
            const logDiv = document.getElementById('consoleLog');
            logDiv.innerHTML = logEntries.slice(-50).join('<br>');
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function clearLog() {
            logEntries = [];
            updateLogDisplay();
        }

        function addTestResult(test, status, message) {
            testResults.push({ test, status, message });
            updateTestResults();
        }

        function updateTestResults() {
            const resultsDiv = document.getElementById('testResults');
            resultsDiv.innerHTML = testResults.map(result => 
                `<div class="status ${result.status}">
                    <strong>${result.test}:</strong> ${result.message}
                </div>`
            ).join('');
        }

        async function testMainApp() {
            log('üîç Testing main app...');
            try {
                const response = await fetch('http://localhost:8080');
                const text = await response.text();
                
                if (response.ok) {
                    addTestResult('Main App Response', 'success', `HTTP ${response.status} - ${text.length} characters`);
                    
                    if (text.includes('<div id="root"></div>')) {
                        addTestResult('Root Element', 'success', 'Found root div');
                    } else {
                        addTestResult('Root Element', 'error', 'Root div not found');
                    }
                    
                    if (text.includes('script')) {
                        addTestResult('Scripts', 'success', 'Script tags found');
                    } else {
                        addTestResult('Scripts', 'error', 'No script tags found');
                    }
                } else {
                    addTestResult('Main App Response', 'error', `HTTP ${response.status}`);
                }
            } catch (error) {
                addTestResult('Main App Response', 'error', error.message);
                log(`‚ùå Main app test failed: ${error.message}`, 'error');
            }
        }

        async function testJavaScriptLoading() {
            log('üîç Testing JavaScript loading...');
            try {
                const response = await fetch('http://localhost:8080/src/main.tsx');
                if (response.ok) {
                    const text = await response.text();
                    if (text.includes('console.log')) {
                        addTestResult('JavaScript Loading', 'success', 'main.tsx loads with debug logs');
                    } else {
                        addTestResult('JavaScript Loading', 'warning', 'main.tsx loads but no debug logs');
                    }
                } else {
                    addTestResult('JavaScript Loading', 'error', `HTTP ${response.status}`);
                }
            } catch (error) {
                addTestResult('JavaScript Loading', 'error', error.message);
            }
        }

        async function testReactDependencies() {
            log('üîç Testing React dependencies...');
            try {
                const response = await fetch('http://localhost:8080/node_modules/.vite/deps/react.js');
                if (response.ok) {
                    addTestResult('React Dependencies', 'success', 'React loads correctly');
                } else {
                    addTestResult('React Dependencies', 'error', `HTTP ${response.status}`);
                }
            } catch (error) {
                addTestResult('React Dependencies', 'error', error.message);
            }
        }

        async function testCSSLoading() {
            log('üîç Testing CSS loading...');
            try {
                const response = await fetch('http://localhost:8080/src/index.css');
                if (response.ok) {
                    addTestResult('CSS Loading', 'success', 'CSS loads correctly');
                } else {
                    addTestResult('CSS Loading', 'error', `HTTP ${response.status}`);
                }
            } catch (error) {
                addTestResult('CSS Loading', 'error', error.message);
            }
        }

        async function testSupabaseConnection() {
            log('üîç Testing Supabase connection...');
            try {
                const response = await fetch('https://jedfundfhzytpnbjkspn.supabase.co');
                if (response.ok || response.status === 400) {
                    addTestResult('Supabase Connection', 'success', 'Supabase server responding');
                } else {
                    addTestResult('Supabase Connection', 'error', `HTTP ${response.status}`);
                }
            } catch (error) {
                addTestResult('Supabase Connection', 'error', error.message);
            }
        }

        function enableDevBypass() {
            localStorage.setItem('dev-bypass-auth', 'true');
            log('‚úÖ Dev bypass enabled');
            addTestResult('Dev Bypass', 'success', 'Enabled in localStorage');
        }

        function clearAllData() {
            localStorage.clear();
            sessionStorage.clear();
            log('üóëÔ∏è All data cleared');
            addTestResult('Data Clear', 'success', 'localStorage and sessionStorage cleared');
        }

        async function runAllTests() {
            log('üöÄ Running all tests...');
            testResults = [];
            updateTestResults();
            
            await testMainApp();
            await testJavaScriptLoading();
            await testReactDependencies();
            await testCSSLoading();
            await testSupabaseConnection();
            
            log('‚úÖ All tests completed');
        }

        // Initialize
        log('üöÄ Console debug test page loaded');
        
        // Auto-run tests on load
        setTimeout(runAllTests, 1000);
    </script>
</body>
</html>
