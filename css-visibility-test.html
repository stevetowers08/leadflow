<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSS Visibility Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: white;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        .test-section {
            background: #1e293b;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #2563eb;
        }
        .button.success { background: #10b981; }
        .button.danger { background: #dc2626; }
        .button.warning { background: #f59e0b; }
        .log {
            background: #000;
            color: #00ff00;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            margin: 10px 0;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .test-element {
            padding: 20px;
            margin: 10px 0;
            border: 2px solid #3b82f6;
            background: #1e293b;
        }
        .hidden-test {
            display: none;
        }
        .invisible-test {
            visibility: hidden;
        }
        .opacity-test {
            opacity: 0;
        }
        .position-test {
            position: absolute;
            left: -9999px;
        }
        .z-index-test {
            z-index: -1;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç CSS Visibility Test</h1>
        
        <div class="test-section">
            <h2>Visibility Tests</h2>
            <div class="test-element">‚úÖ Normal element - should be visible</div>
            <div class="test-element hidden-test">‚ùå Hidden element (display: none)</div>
            <div class="test-element invisible-test">‚ùå Invisible element (visibility: hidden)</div>
            <div class="test-element opacity-test">‚ùå Transparent element (opacity: 0)</div>
            <div class="test-element position-test">‚ùå Off-screen element (position: absolute)</div>
            <div class="test-element z-index-test">‚ùå Behind element (z-index: -1)</div>
        </div>

        <div class="test-section">
            <h2>Main App CSS Test</h2>
            <div id="mainAppCssTest" class="test-element">
                <p>Testing main app CSS...</p>
            </div>
        </div>

        <div class="test-section">
            <h2>Actions</h2>
            <button class="button" onclick="testMainAppCSS()">Test Main App CSS</button>
            <button class="button" onclick="testCSSLoading()">Test CSS Loading</button>
            <button class="button" onclick="testElementVisibility()">Test Element Visibility</button>
            <button class="button success" onclick="enableDevBypass()">Enable Dev Bypass</button>
        </div>

        <div class="test-section">
            <h2>CSS Test Log</h2>
            <div id="cssLog" class="log"></div>
            <button class="button" onclick="clearLog()">Clear Log</button>
        </div>
    </div>

    <script>
        let logEntries = [];

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const entry = `[${timestamp}] [${type.toUpperCase()}] ${message}`;
            logEntries.push(entry);
            updateLogDisplay();
        }

        function updateLogDisplay() {
            const logDiv = document.getElementById('cssLog');
            logDiv.textContent = logEntries.slice(-100).join('\n');
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function clearLog() {
            logEntries = [];
            updateLogDisplay();
        }

        async function testMainAppCSS() {
            log('üîç Testing main app CSS...');
            
            try {
                const response = await fetch('http://localhost:8080/src/index.css');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const cssContent = await response.text();
                log('‚úÖ Main app CSS loaded');
                log(`CSS length: ${cssContent.length} characters`);
                
                // Check for specific CSS patterns that might cause issues
                const problematicPatterns = [
                    'display: none',
                    'visibility: hidden',
                    'opacity: 0',
                    'position: absolute',
                    'left: -9999px',
                    'z-index: -1'
                ];
                
                problematicPatterns.forEach(pattern => {
                    if (cssContent.includes(pattern)) {
                        log(`‚ö†Ô∏è Found potentially problematic CSS: ${pattern}`, 'warning');
                    }
                });
                
                // Check for body/html styles
                if (cssContent.includes('body') || cssContent.includes('html')) {
                    log('‚úÖ Found body/html styles');
                } else {
                    log('‚ùå No body/html styles found');
                }
                
                // Check for root element styles
                if (cssContent.includes('#root')) {
                    log('‚úÖ Found #root styles');
                } else {
                    log('‚ùå No #root styles found');
                }
                
                // Apply the CSS to our test element
                const testElement = document.getElementById('mainAppCssTest');
                const style = document.createElement('style');
                style.textContent = cssContent;
                document.head.appendChild(style);
                log('‚úÖ Main app CSS applied to test element');
                
            } catch (error) {
                log(`‚ùå Main app CSS test failed: ${error.message}`, 'error');
            }
        }

        async function testCSSLoading() {
            log('üîç Testing CSS loading...');
            
            const cssUrls = [
                'http://localhost:8080/src/index.css',
                'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap'
            ];
            
            for (const url of cssUrls) {
                try {
                    const response = await fetch(url);
                    if (response.ok) {
                        log(`‚úÖ CSS loaded: ${url}`);
                    } else {
                        log(`‚ùå CSS failed: ${url} - ${response.status}`);
                    }
                } catch (error) {
                    log(`‚ùå CSS error: ${url} - ${error.message}`, 'error');
                }
            }
        }

        function testElementVisibility() {
            log('üîç Testing element visibility...');
            
            const testElement = document.getElementById('mainAppCssTest');
            const computedStyle = window.getComputedStyle(testElement);
            
            log(`Display: ${computedStyle.display}`);
            log(`Visibility: ${computedStyle.visibility}`);
            log(`Opacity: ${computedStyle.opacity}`);
            log(`Position: ${computedStyle.position}`);
            log(`Z-index: ${computedStyle.zIndex}`);
            log(`Width: ${computedStyle.width}`);
            log(`Height: ${computedStyle.height}`);
            
            // Test if element is actually visible
            const rect = testElement.getBoundingClientRect();
            log(`Bounding rect: ${rect.width}x${rect.height} at (${rect.left}, ${rect.top})`);
            
            if (rect.width === 0 || rect.height === 0) {
                log('‚ùå Element has zero dimensions', 'error');
            } else {
                log('‚úÖ Element has non-zero dimensions');
            }
            
            if (rect.left < 0 || rect.top < 0) {
                log('‚ö†Ô∏è Element is positioned off-screen', 'warning');
            } else {
                log('‚úÖ Element is positioned on-screen');
            }
        }

        function enableDevBypass() {
            localStorage.setItem('dev-bypass-auth', 'true');
            log('‚úÖ Dev bypass enabled');
        }

        // Initialize
        log('üöÄ CSS visibility test loaded');
        
        // Auto-run tests
        setTimeout(() => {
            testElementVisibility();
            testCSSLoading();
        }, 1000);
    </script>
</body>
</html>
